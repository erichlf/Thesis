The main goal of this section is to develop a rigorous numerical analysis for
\autoref{alg:TwoLevel}. The proof for the error bounds follows a very similar pattern presented in
\cite{Fairag98}.

To this end, we first introduce an improved bound on the trilinear form $a_2(\zeta; \xi, \chi)$ using
the discrete Sobolev inequality, i.e.
\begin{equation*}
  \|\nabla \varphi^h\|_{L^{\infty}} \le c \sqrt{|\ln(h)|}\cdot |\varphi^h|_2.
\end{equation*}
The following lemma follows from the above inequality and \eqref{eqn:a2Cont} %\cite{Fairag98}
\begin{lemma} \label{lma:bImproved}
  For any $\chi^h\in X^h$, the following inequalities hold
  \begin{align*}
    |a_2(\psi;\chi^h,\xi)| &\le C\sqrt{|\ln(h)|} \cdot |\psi|_2 |\xi|_1 |\chi^h|_2, \\
    |a_2(\psi;\xi,\chi^h)| &\le C\sqrt{|\ln(h)|} \cdot |\psi|_2 |\xi|_1 |\chi^h|_2.
  \end{align*}
\end{lemma}
The following lemma will prove useful for proving the error bounds for \autoref{alg:TwoLevel}
\begin{lemma} \label{lma:trilinear}
  For $\psi,\,\xi,\,\chi\in H^2_0(\Omega)$, we have
  \begin{equation}
    a_2(\psi; \xi, \chi) = a_2^*(\xi; \chi, \psi) - a_2^*(\chi; \xi, \psi)
    \label{eqn:eqn:trilinear}
  \end{equation}
  where
  \begin{equation}
    a_2^*(\xi; \chi, \psi) = \int_{\Omega}\! (\chi_y\xi_{xy}-\xi_x\chi_{yy}) \psi_y -
    (\xi_y\chi_{yx}-\xi_y\chi_{xx}) \psi_x \,d\vec{x}.
    \label{eqn:trilinear}
  \end{equation}
\end{lemma}
For a proof see \cite{Fairag98}.

The following theorem gives the error bound after Step 2 and is the main result of this paper. The
proof of this theorem is similar to the proof for a similar theorem in \cite{Fairag98}.
\begin{thm} \label{thm:2LTwoLevel}
  Let $X^h,\, X^H\in H^2_0(\Omega)$ be two finite element spaces. Let $\psi$ be the solution to
  \eqref{eqn:SQGEWF} and $\psi^h$ the solution to \eqref{eqn:Fine}. Then $\psi^h$ satisfies
  \begin{equation}
    |\psi-\psi^h|_2 \le C_1 \inf_{\lambda^h\in X^h} |\psi-\lambda^h|_2 + C_2 \sqrt{|\ln h|}\cdot |\psi - \psi^H|_1
    \label{eqn:Error}
  \end{equation}
  where $C_1 = 2 + Re\,Ro^{-1} + Re^2 Ro^{-1} \Gamma_1 \|F\|_{-2}$ and $C_2= 2 Re^2 Ro^{-1} \Gamma_1
  C\,\|F\|_{-2}$.
\end{thm}
\begin{proof}
  Subtracting \eqref{eqn:Fine} from \eqref{eqn:SQGEWF} and letting $\chi=\chi^h$ yields
  \begin{equation*}
    a_1(\psi - \psi^h,\chi^h) + a_2(\psi;\psi,\chi^h) - a_2(\psi^H;\psi^h,\chi^h)
      + a_3(\psi-\psi^h,\chi^h) = 0, \quad \forall \chi^h \in X^h.
  \end{equation*}
  Using \autoref{lma:trilinear} gives
  \begin{equation*}
    \begin{split}
      a_1(\psi - \psi^h,\chi^h)
        + a_2^*(\psi;\chi^h, \psi) - a_2^*(\chi^h;\psi,\psi) \\
      - a_2^*(\psi^h;\chi^h,\psi^H) + a_2^*(\chi^h; \psi^h,\psi^H)
        + a_3(\psi-\psi^h,\chi^h) = 0, \quad \forall \chi^h \in X^h.
    \end{split}
  \end{equation*}
  Now, adding the terms
  \begin{equation*}
    -a_2^*(\psi^h;\chi^h,\psi) + a_2^*(\chi^h;\psi^h,\psi) + a_2^*(\psi^h;\chi^h,\psi) - a_2^*(\chi^h;\psi^h,\psi)
  \end{equation*}
  gives
  \begin{equation*}
    \begin{split}
      &a_1(\psi - \psi^h,\chi^h)
        + a_2^*(\psi-\psi^h;\chi^h, \psi) + a_2^*(\chi^h;\psi^h-\psi,\psi) \\
      &\quad+ a_2^*(\psi^h;\chi^h,\psi-\psi^H) + a_2^*(\chi^h; \psi^h,\psi^H-\psi)
        + a_3(\psi-\psi^h,\chi^h) = 0, \quad \forall \chi^h \in X^h.
    \end{split}
  \end{equation*}
  Take $\lambda^h\in H^2_0(\Omega)$ arbitrary and define $e:= \psi - \psi^h = \eta - \Phi^h$ where
  $\Phi^h = \psi^h-\lambda^h$ and $\eta=\psi-\lambda^h$ and we have
  \begin{equation*}
    \begin{split}
      &a_1(\Phi^h,\chi^h)
        + a_2^*(\Phi^h;\chi^h, \psi) - a_2^*(\chi^h;\Phi^h,\psi)
        + a_3(\Phi^h,\chi^h) \\
      &\quad = a_1(\eta,\chi^h)
        + a_2^*(\eta;\chi^h, \psi) - a_2^*(\chi^h;\eta,\psi) \\
      &\quad+ a_2^*(\psi^h;\chi^h,\psi-\psi^H) + a_2^*(\chi^h; \psi^h,\psi^H-\psi)
        + a_3(\eta,\chi^h), \quad \forall \chi^h \in X^h.
    \end{split}
  \end{equation*}
  Since this holds for any $\chi^h\in H^2_0(\Omega)$ it holds in particular for $\chi^h=\Phi^h\in H^2_0(\Omega)$ which
  implies
  \begin{equation*}
    \begin{split}
      a_1(\Phi^h,\Phi^h) + a_3(\Phi^h,\Phi^h) &= a_1(\eta,\Phi^h)
        + a_2^*(\eta;\Phi^h, \psi) - a_2^*(\Phi^h;\eta,\psi) \\
      &\quad+ a_2^*(\psi^h;\Phi^h,\psi-\psi^H) + a_2^*(\Phi^h; \psi^h,\psi^H-\psi)
        + a_3(\eta,\Phi^h).
    \end{split}
  \end{equation*}
  Note that $a_3(\psi,\chi) = -a_3(\chi,\psi)$ and so it follows that $a_3(\Phi^h,\Phi^h) = 0$. This combined with
  \autoref{lma:trilinear} implies
  \begin{equation*}
    \begin{split}
      a_1(\Phi^h,\Phi^h) &= a_1(\eta,\Phi^h) + a_2(\psi;\eta,\Phi^h) \\
      &\quad+ a_2^*(\psi^h;\Phi^h,\psi-\psi^H) + a_2^*(\Phi^h; \psi^h,\psi^H-\psi)
        + a_3(\eta,\Phi^h).
    \end{split}
  \end{equation*}
  Using the error bounds given in \eqref{eqn:a1Cont}, \eqref{eqn:a2Cont}, \eqref{eqn:a3Cont},
  \eqref{eqn:lCont}, \autoref{lma:bImproved}, \autoref{thm:stability_sqge},
  \autoref{thm:stability_fem_sqge} and \autoref{lma:Fine} gives
  \begin{align*}
    Re^{-1} |\Phi^h|_2^2 &\le Re^{-1} |\eta|_2\, |\Phi^h|_2 + \Gamma_1\, |\psi|_2\, |\eta|_2\, |\Phi^h|_2 \\
      &\quad+ 2 \Gamma_1\, C\, |\psi^H|_2\, |\Phi^h|_2\, |\psi - \psi^H|_1 \sqrt{|\ln(h)|} + Ro^{-1}
        |\eta|_2\, |\Phi^h|_2 \\
    &= \left(Ro^{-1} + Re^{-1} + \Gamma_1\, |\psi|_2\right) |\eta|_2\, |\Phi^h|_2 + 2 \Gamma_1\, C\,
      |\psi^H|_2\, |\Phi^h|_2 |\psi - \psi^H|_1 \sqrt{|\ln(h)|}  \\
    |\Phi^h|_2 &\le \left(1 + Re\, Ro^{-1} + Re^2 Ro^{-1} \Gamma_1\, \|F\|_{-2}\right) |\eta|_2 \\
      &\quad + 2 Re^2 Ro^{-1} \Gamma_1\, C\, \|F\|_{-2}\, |\psi - \psi^H|_1 \sqrt{|\ln(h)|} \\
  \end{align*}
  Adding $|\eta|_2$ to both sides and using the triangle inequality ($|\psi - \psi^h|_2 \le |\Phi^h|_2 + |\eta|_2$) gives
  \begin{align*}
    |\Phi^h|_2 &\le \left(2 + Re\, Ro^{-1} + Re^2 Ro^{-1} \Gamma_1\, \|F\|_{-2}\right) |\eta|_2 \\
      &\quad + 2 Re^2 Ro^{-1} \Gamma_1\, C\, \|F\|_{-2}\, |\psi - \psi^H|_1 \sqrt{|\ln(h)|} \\
  \end{align*}
  Thus, we have the following estimate for the error bounds
  \begin{equation*}
    |\psi-\psi^h|_2 \le C_1 \inf_{\lambda^h\in X^h} |\psi-\lambda^h|_2 + C_2 \sqrt{|\ln h|}\cdot |\psi -
      \psi^H|_1
  \end{equation*}
  where $C_1 = 2 + Re\,Ro^{-1} + Re^2 Ro^{-1} \Gamma_1 \|F\|_{-2}$ and $C_2= 2 Re^2 Ro^{-1} \Gamma_1
  C\,\|F\|_{-2}$.
\end{proof}

As an example, consider the case of the Argyris triangle; for this element we have the following inequalities
for this particular element the following theorem follows from approximation theory \cite{Bernadou94} and Theorem 6.1.1 \cite{Ciarlet}:
\begin{align*}
  |\psi - \psi^h|_j &\le Ch^{6-j} \\
  |\psi - \psi^H|_j &\le CH^{6-j}
\end{align*}
\begin{corollary} \label{crl:Argyris2L}
  Let $X^h,\, X^H \in H^2_0(\Omega)$ be the Argyris finite elements, then $\psi^h$ satisfies
  \begin{equation}
    |\psi - \psi^h|_2 \le C_1 h^4 + C_2 \sqrt{|\ln(h)|}\cdot H^5.
    \label{eqn:TwoLevelError}
  \end{equation}
\end{corollary}
\begin{proof}
  This follows directly by substituting the inequalities for the Argyris triangle bounds into \eqref{eqn:Error}.
\end{proof}
